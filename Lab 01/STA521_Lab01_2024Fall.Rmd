---
title: "STA521_Lab01_2024_Fall"
author: "Justin Kao"
date: "`r Sys.Date()`"
output: html_document
---

```{=html}
<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}

</style>
```
### 1. Load the dataset. Source: Kaggle

```{r}
rm(list=ls()) # Clear the environment
data <- read.csv("Student_Performance.csv", header = TRUE)
```

### 2. Library needed

```{r}
library(dplyr) # For data manipulation
library(ggplot2) # For data visualization
library(readr) # For reading CSV files 
library(ggcorrplot) #For checking Correlation Coefficient
```

### 3. Basic EDA

```{r}
# Check the structure of the dataset to ensure it has loaded correctly
str(data)
dim(data)
```

```{r}
# View the first few rows of the dataset
head(data)

# Summary statistics to get an overview of the dataset
summary(data)
```

### 4. Visualization

::: {.alert .alert-info}
<strong>Info!</strong> Before doing the regression, knowing the distribution of y is important
:::

#### 1. Histogram of Performance Index

-   If you only need to edit the title (keeping the x-axis and y-axis labels the same as the variable names or default settings), `ggtitle()` is the easiest way to do so.

```{r}
ggplot(data = data, aes(x = Performance.Index)) + 
  geom_histogram() +
  ggtitle("Histogram of Performance Index")
```

-   If you want to edit the title, subtitle, x-axis label, y-axis label, caption, or legend title (e.g., fill), then use the `labs()` function.

```{r}
ggplot(data, aes(x = Performance.Index)) +
  geom_histogram() +
  labs(x = "Performance Index",
       y = "Count",
       title = "Histogram of Performance Index",
       fill = "Legend Title",
       caption = "Source: Student Performance Dataset from Kaggle")
```

-   If you want to change the color, binwidth, or fill color of a histogram, use the geom_histogram() function.

```{r}
ggplot(data, aes(x = Performance.Index)) +
  geom_histogram(binwidth = 1, color = "red", fill = "green" ) +
  labs(x = "Performance Index",
       y = "Count",
       title = "Histogram of Performance Index",
       fill = "Legend Title",
       caption = "Source: Student Performance Dataset from Kaggle")
```

```{r}
ggplot(data, aes(x = Performance.Index)) +
  geom_histogram(binwidth = 1, alpha = 0.5, aes(fill = after_stat(count))) +
  scale_fill_gradient(low = "red", high = "green") +
  labs(title = "Histogram of Performance Index",
       x = "Performance Index",
       y = "Count",
       fill = "Number of obs",
       caption = "Source: Student Performance Dataset from Kaggle")
```

::: {.alert .alert-info} 
<strong>Info!</strong> Now, let's create some plots for the x variables to gain insights into the explanatory variables. 
:::

#### 2. Boxplot of Performance Index by Extracurricular Activities

```{r}
ggplot(data, aes(x = Extracurricular.Activities, y = Performance.Index)) +
  geom_boxplot() +
  labs(title = "Performance Index by Extracurricular Activities",
       x = "Extracurricular Activities", 
       y = "Performance Index",
       caption = "Source: Student Performance Dataset from Kaggle")
```
```{r}
ggplot(data, aes(x = Extracurricular.Activities, y = Performance.Index))+
  geom_boxplot(color = "red", fill = "green") +
  labs(title = "Performance Index by Extracurricular Activities",
       x = "Extracurricular Activities", 
       y = "Performance Index",
       caption = "Source: Student Performance from Kaggle") +
  scale_y_continuous(breaks = seq(0, max(data$Performance.Index), by = 5))
```

#### 3. Scatter Plots

```{r}
# Scatter plot between Hours Studied and Performance Index
ggplot(data, aes(x = Hours.Studied, y = Performance.Index)) +
  geom_point(color = "darkblue", alpha = 0.6) +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Hours Studied vs Performance Index", 
       x = "Hours Studied", 
       y = "Performance Index")

# Scatter plot between Previous Scores and Performance Index
ggplot(data, aes(x = Previous.Scores, y = Performance.Index)) +
  geom_point(color = "darkgreen", alpha = 0.6) +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Previous Scores vs Performance Index", 
       x = "Previous Scores", 
       y = "Performance Index")
```


#### 4. Correlation coefficient 

```{r}
# Calculate correlation matrix
corr_matrix <- cor(data[, sapply(data, is.numeric)], use = "complete.obs")

# Plot correlation matrix heatmap
ggcorrplot(corr_matrix, method = "circle", lab = TRUE) +
  labs(title = "Correlation Matrix of Numerical Variables")
```



### 5. Multiple Linear Regression Model  

```{r}
model <- lm(Performance.Index ~ Hours.Studied + Previous.Scores + Sleep.Hours + 
              Sample.Question.Papers.Practiced + Extracurricular.Activities, 
            data = data)
```

```{r}
summary(model)
```
